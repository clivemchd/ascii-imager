import{S as t,P as e,W as i,A as a,D as s,a as n,b as r,R as o,L as h,M as l,C as d,c,B as m,d as u,e as g,f as p,T as f,O as w,g as v,h as y,i as I,j as x,k as C}from"./three-CSkUAhBd.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class M{constructor(){this.container=document.getElementById("threejs-background"),this.scene=new t,this.camera=new e(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new i({alpha:!0,antialias:!0}),this.asciiChars="@%#*+=-:. ",this.textMeshes=[],this.framebufferTexture=null,this.renderTarget=null,this.time=0,this.init(),this.createFramebuffer(),this.createASCIIField(),this.animate(),this.handleResize()}init(){this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(0,0),this.container.appendChild(this.renderer.domElement),this.camera.position.z=10;const t=new a(4210752,.6);this.scene.add(t);const e=new s(65416,.8);e.position.set(5,5,5),this.scene.add(e);const i=new n(39423,.6,50);i.position.set(-5,-5,5),this.scene.add(i)}createFramebuffer(){this.renderTarget=new r(512,512,{minFilter:h,magFilter:h,format:o})}createASCIIField(){for(let t=0;t<15;t++)for(let e=0;e<15;e++)for(let i=0;i<5;i++){const a=this.asciiChars[Math.floor(Math.random()*this.asciiChars.length)],s=this.createASCIIGeometry(a),n=new l({color:(new d).setHSL(.4+.2*Math.sin(.1*t+.1*e),.7,.6+.3*Math.cos(.2*i)),transparent:!0,opacity:.4+.3*Math.random(),wireframe:Math.random()>.7}),r=new c(s,n);r.position.set(1.5*(t-7.5),1.5*(e-7.5),1.5*(i-2)*2),r.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),r.userData={originalPosition:r.position.clone(),rotationSpeed:{x:.02*(Math.random()-.5),y:.02*(Math.random()-.5),z:.02*(Math.random()-.5)},floatSpeed:.01*Math.random()+.005,floatAmplitude:2*Math.random()+.5,phaseOffset:Math.random()*Math.PI*2},this.textMeshes.push(r),this.scene.add(r)}this.createFlowingParticles()}createASCIIGeometry(t){switch(t){case"@":return new u(.15,8,8);case"%":return new m(.2,.2,.2);case"#":return new w(.15);case"*":return new f(.15);case"+":return new p(.1,.3,4);case"=":return new g(.1,.1,.3,6);case"-":return new m(.3,.05,.05);case":":return new g(.05,.05,.2,8);case".":return new u(.05,6,6);default:return new m(.1,.1,.1)}}createFlowingParticles(){const t=200,e=new v,i=new Float32Array(600),a=new Float32Array(600),s=new Float32Array(t);for(let r=0;r<t;r++){i[3*r]=30*(Math.random()-.5),i[3*r+1]=30*(Math.random()-.5),i[3*r+2]=20*(Math.random()-.5);const t=.3+.4*Math.random(),e=(new d).setHSL(t,.8,.7);a[3*r]=e.r,a[3*r+1]=e.g,a[3*r+2]=e.b,s[r]=.5*Math.random()+.1}e.setAttribute("position",new y(i,3)),e.setAttribute("color",new y(a,3)),e.setAttribute("size",new y(s,1));const n=new I({size:.2,vertexColors:!0,transparent:!0,opacity:.6,blending:x});this.particles=new C(e,n),this.scene.add(this.particles)}updateFramebuffer(){if(this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null),this.textMeshes.length>0&&this.renderTarget.texture){this.textMeshes.filter((t,e)=>e%10==0).forEach(t=>{Math.random()>.95&&(t.material.map=this.renderTarget.texture,t.material.needsUpdate=!0)})}}animate(){if(requestAnimationFrame(()=>this.animate()),this.time+=.01,this.textMeshes.forEach((t,e)=>{const i=t.userData;t.rotation.x+=i.rotationSpeed.x,t.rotation.y+=i.rotationSpeed.y,t.rotation.z+=i.rotationSpeed.z;const a=Math.sin(this.time*i.floatSpeed+i.phaseOffset)*i.floatAmplitude,s=Math.cos(this.time*i.floatSpeed*.7+i.phaseOffset)*i.floatAmplitude*.5,n=Math.sin(this.time*i.floatSpeed*1.3+i.phaseOffset)*i.floatAmplitude*.3;t.position.x=i.originalPosition.x+s,t.position.y=i.originalPosition.y+a,t.position.z=i.originalPosition.z+n;const r=(.4+.3*Math.sin(.5*this.time+.1*e))%1;t.material.color.setHSL(r,.7,.6),t.material.opacity=.3+.2*Math.sin(2*this.time+.2*e)}),this.particles){const t=this.particles.geometry.attributes.position.array;for(let e=0;e<t.length;e+=3)t[e]+=.002*Math.sin(this.time+e),t[e+1]+=.002*Math.cos(this.time+e),t[e+2]+=.001*Math.sin(.5*this.time+e),t[e]>15&&(t[e]=-15),t[e]<-15&&(t[e]=15),t[e+1]>15&&(t[e+1]=-15),t[e+1]<-15&&(t[e+1]=15);this.particles.geometry.attributes.position.needsUpdate=!0,this.particles.rotation.x+=.001,this.particles.rotation.y+=.002}this.camera.position.x=8*Math.cos(.3*this.time)*.3,this.camera.position.y=8*Math.sin(.2*this.time)*.2,this.camera.position.z=10+2*Math.sin(.1*this.time),this.camera.lookAt(0,0,0),this.updateFramebuffer(),this.renderer.render(this.scene,this.camera)}handleResize(){window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderTarget.setSize(Math.min(window.innerWidth,512),Math.min(window.innerHeight,512))})}}class b{constructor(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.imageInput=document.getElementById("imageInput"),this.originalImage=document.getElementById("originalImage"),this.asciiOutput=document.getElementById("asciiOutput"),this.convertBtn=document.getElementById("convertBtn"),this.downloadBtn=document.getElementById("downloadBtn"),this.loading=document.getElementById("loading"),this.totalChars=document.getElementById("totalChars"),this.charsetSelect=document.getElementById("charsetSelect"),this.customCharset=document.getElementById("customCharset"),this.customInputGroup=document.getElementById("customInputGroup"),this.downloadFormat=document.getElementById("downloadFormat"),this.invertColors=document.getElementById("invertColors"),this.textColor=document.getElementById("textColor"),this.backgroundColor=document.getElementById("backgroundColor"),this.currentImage=null,this.asciiResult="",this.initializeEventListeners()}initializeEventListeners(){this.imageInput.addEventListener("change",t=>this.handleImageUpload(t)),this.convertBtn.addEventListener("click",()=>this.convertToAscii()),this.downloadBtn.addEventListener("click",()=>this.downloadAscii()),this.charsetSelect.addEventListener("change",()=>{this.toggleCustomInput()}),this.textColor.addEventListener("change",()=>{this.updateOutputColors()}),this.backgroundColor.addEventListener("change",()=>{this.updateOutputColors()});const t=document.querySelector(".file-input");t.addEventListener("dragover",e=>{e.preventDefault(),t.style.borderColor="#007bff"}),t.addEventListener("dragleave",()=>{t.style.borderColor="#ddd"}),t.addEventListener("drop",e=>{e.preventDefault(),t.style.borderColor="#ddd";const i=e.dataTransfer.files;i.length>0&&this.handleImageFile(i[0])})}toggleCustomInput(){"custom"===this.charsetSelect.value?this.customInputGroup.classList.remove("hidden"):this.customInputGroup.classList.add("hidden")}handleImageUpload(t){const e=t.target.files[0];e&&this.handleImageFile(e)}handleImageFile(t){if(!t.type.startsWith("image/"))return void alert("Please select a valid image file.");const e=new FileReader;e.onload=e=>{this.currentImage=new Image,this.currentImage.onload=()=>{const i=document.getElementById("fileInputArea");i.style.backgroundImage=`url(${e.target.result})`,i.classList.add("has-image");const a=document.getElementById("uploadText"),s=document.getElementById("imageInfo"),n=document.getElementById("imageName"),r=document.getElementById("imageDimensions");a.textContent="Image loaded - Click to change",n.textContent=`üìÅ ${t.name}`,r.textContent=`üìê ${this.currentImage.width} √ó ${this.currentImage.height}px`,s.classList.remove("hidden"),this.convertBtn.disabled=!1},this.currentImage.src=e.target.result},e.readAsDataURL(t)}getCharacterSet(){const t={detailed:"@%#*+=-:. ",simple:"‚ñà‚ñâ‚ñä‚ñã‚ñå‚ñç‚ñé‚ñè ",blocks:"‚ñà‚ñà‚ñì‚ñí‚ñë  "};if("custom"===this.charsetSelect.value){const e=this.customCharset.value.trim();return 0===e.length?(alert("Please enter custom characters!"),t.detailed):e}return t[this.charsetSelect.value]||t.detailed}updateOutputColors(){this.asciiOutput&&(this.asciiOutput.style.backgroundColor=this.backgroundColor.value,this.asciiOutput.style.color=this.textColor.value)}convertToAscii(){if(!this.currentImage)return;if("custom"===this.charsetSelect.value){if(0===this.customCharset.value.trim().length)return void alert("Please enter custom characters before converting!")}const t=this.totalChars.value.trim();if(t&&!isNaN(t)){const e=parseInt(t);if(e<100)return void alert("Total characters must be at least 100!");if(e>5e6)return void alert("Total characters cannot exceed 5,000,000 for performance reasons!")}this.loading.classList.remove("hidden"),this.asciiOutput.classList.add("hidden"),setTimeout(()=>{const t=this.getCharacterSet(),e=this.invertColors.checked;let i,a;const s=this.totalChars.value.trim();if(s&&!isNaN(s)&&parseInt(s)>0){const t=parseInt(s),e=this.currentImage.height/this.currentImage.width;i=Math.round(Math.sqrt(t/(.5*e))),a=Math.round(t/i),i=Math.max(i,10),a=Math.max(a,5),console.log(`Using total characters: ${t}, calculated dimensions: ${i}√ó${a} = ${i*a} chars`)}else{i=100;const t=this.currentImage.height/this.currentImage.width;a=Math.floor(i*t*.5),console.log(`Using default width: ${i}, calculated height: ${a}, total: ${i*a} chars`)}this.canvas.width=i,this.canvas.height=a,this.ctx.drawImage(this.currentImage,0,0,i,a);const n=this.ctx.getImageData(0,0,i,a).data;let r="";for(let o=0;o<a;o++){for(let a=0;a<i;a++){const s=4*(o*i+a),h=(n[s]+n[s+1]+n[s+2])/3,l=Math.max(0,Math.min(255,1*h)),d=Math.floor(l/255*(t.length-1));r+=t[e?t.length-1-d:d]}r+="\n"}this.asciiResult=r,this.asciiOutput.textContent=r,this.adjustFontSizeForCharacterCount(i,a),this.asciiOutput.classList.remove("hidden"),this.downloadBtn.classList.remove("hidden"),this.loading.classList.add("hidden"),this.updateOutputColors()},100)}adjustFontSizeForCharacterCount(t,e){const i=Math.max(1,Math.floor(800/t)),a=Math.max(1,Math.floor(600/e)),s=Math.min(i,a),n=s;this.asciiOutput.style.fontSize=`${s}px`,this.asciiOutput.style.lineHeight=`${n}px`,console.log(`Adjusted font size to ${s}px for ${t}√ó${e} character grid`)}downloadAscii(){if(!this.asciiResult)return;switch(this.downloadFormat.value){case"png":default:this.downloadAsPNG();break;case"svg":this.downloadAsSVG();break;case"txt":this.downloadAsText()}}downloadAsPNG(){const t=document.createElement("canvas"),e=t.getContext("2d");e.font="16px 'Courier New', monospace";const i=this.asciiResult.split("\n").filter(t=>t.length>0),a=Math.max(...i.map(t=>t.length)),s=e.measureText("M").width,n=Math.ceil(a*s)+40,r=Math.ceil(16*i.length)+40,o=2*n,h=2*r;t.width=o,t.height=h,e.scale(2,2),e.imageSmoothingEnabled=!0,e.imageSmoothingQuality="high",e.textRenderingOptimization="optimizeQuality",e.fillStyle=this.backgroundColor.value,e.fillRect(0,0,n,r),e.font="16px 'Courier New', monospace",e.fillStyle=this.textColor.value,e.textBaseline="top",e.textAlign="left",i.forEach((t,i)=>{const a=20+16*i;e.fillText(t,20,a)}),t.toBlob(t=>{const e=URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="ascii-art-hq.png",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(e)},"image/png",1)}downloadAsSVG(){const t=this.asciiResult.split("\n").filter(t=>t.length>0),e=Math.max(...t.map(t=>t.length)),i=Math.ceil(9.6*e)+40,a=Math.ceil(18*t.length)+40;let s=`<?xml version="1.0" encoding="UTF-8"?>\n<svg xmlns="http://www.w3.org/2000/svg" width="${i}" height="${a}" viewBox="0 0 ${i} ${a}">\n    <rect width="100%" height="100%" fill="${this.backgroundColor.value}"/>\n    <style>\n        .ascii-text {\n            font-family: 'Courier New', monospace;\n            font-size: 16px;\n            fill: ${this.textColor.value};\n            white-space: pre;\n            font-weight: normal;\n            text-rendering: optimizeLegibility;\n            shape-rendering: crispEdges;\n        }\n    </style>`;t.forEach((t,e)=>{s+=`\n    <text x="20" y="${20+18*e+16-2}" class="ascii-text">${t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}</text>`}),s+="\n</svg>";const n=new Blob([s],{type:"image/svg+xml"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download="ascii-art-hq.svg",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)}downloadAsText(){const t=new Blob([this.asciiResult],{type:"text/plain"}),e=URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="ascii-art.txt",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(e)}}document.addEventListener("DOMContentLoaded",()=>{new M,new b});
